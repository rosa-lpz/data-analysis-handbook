{
  "$schema": "https://developer.microsoft.com/json-schemas/fabric/item/semanticModel/unappliedChanges/1.0.0/schema.json",
  "conceptualSchemaSettings": {},
  "queries": [
    {
      "name": "prod_data",
      "lineageTag": "c881a85e-6433-49df-b869-2ccc8f90fb8f",
      "navigationStepName": "Navegaci√≥n",
      "text": [
        "let",
        "    Origen = Excel.Workbook(File.Contents(\"C:\\Users\\rosal\\Repositories\\GitHub\\handbooks\\data-analysis-handbook\\data-visualization\\power-bi\\examples\\sorting-tables\\data\\prod_data3.xlsx\"), null, true),",
        "    Sheet1_Sheet = Origen{[Item=\"Sheet1\",Kind=\"Sheet\"]}[Data],",
        "    #\"Promoted Headers\" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true]),",
        "    #\"Added Index\" = Table.AddIndexColumn(#\"Promoted Headers\", \"Index\", 0, 1, Int64.Type),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Index\",{\"Index\", \"Quality Index\", \"Apple 1\", \"Apple2\", \"Apple3\", \"Apple4\", \"Apple5\", \"Apple6\", \"Apple7\", \"Percentage\", \"Date Update\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Reordered Columns\",{{\"Apple 1\", \"Apple1\"}}),",
        "    #\"Run Python script\" = Python.Execute(\"# Run in Power Query#(lf)import pandas as pd#(lf)#(lf)# Get the row where Quality Index == 'Count'#(lf)count_row = dataset[dataset['Quality Index'] == 'Count'].iloc[0]#(lf)#(lf)# Find all Apple columns#(lf)apple_cols = [col for col in dataset.columns if col.startswith('Apple')]#(lf)#(lf)# Create a dictionary of column names and their count values#(lf)count_dict = {col: int(count_row[col]) for col in apple_cols}#(lf)#(lf)# Sort Apple columns by count (descending)#(lf)sorted_apple_cols = sorted(count_dict.keys(), key=lambda x: count_dict[x], reverse=True)#(lf)#(lf)# Reorder all columns: keep Index and Quality Index first, #(lf)# then sorted Apple columns, then the rest#(lf)other_cols = [col for col in dataset.columns #(lf)              if col not in apple_cols and col not in ['Index', 'Quality Index']]#(lf)#(lf)new_column_order = ['Index', 'Quality Index'] + sorted_apple_cols + other_cols#(lf)#(lf)# Reorder the dataframe#(lf)dataset = dataset[new_column_order]# 'dataset' holds the input data for this script#(lf)\",[dataset=#\"Renamed Columns\"])",
        "in",
        "    #\"Run Python script\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Origen = Excel.Workbook(File.Contents(\\\"C:\\\\Users\\\\rosal\\\\Repositories\\\\GitHub\\\\handbooks\\\\data-analysis-handbook\\\\data-visualization\\\\power-bi\\\\examples\\\\tables\\\\prod_data3.xlsx\\\"), null, true),\\n    Sheet1_Sheet = Origen{[Item=\\\"Sheet1\\\",Kind=\\\"Sheet\\\"]}[Data],\\n    #\\\"Promoted Headers\\\" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true]),\\n    #\\\"Added Index\\\" = Table.AddIndexColumn(#\\\"Promoted Headers\\\", \\\"Index\\\", 0, 1, Int64.Type),\\n    #\\\"Reordered Columns\\\" = Table.ReorderColumns(#\\\"Added Index\\\",{\\\"Index\\\", \\\"Quality Index\\\", \\\"Apple 1\\\", \\\"Apple2\\\", \\\"Apple3\\\", \\\"Apple4\\\", \\\"Apple5\\\", \\\"Apple6\\\", \\\"Apple7\\\", \\\"Percentage\\\", \\\"Date Update\\\"}),\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"Reordered Columns\\\",{{\\\"Apple 1\\\", \\\"Apple1\\\"}})\\nin\\n    #\\\"Renamed Columns\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Exception",
      "isHidden": false
    }
  ],
  "queryGroups": [],
  "culture": "en-US",
  "firewallEnabled": true
}